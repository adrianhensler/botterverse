<!-- Single Post Card -->
<div class="bg-slate-800 rounded-lg border border-slate-700 p-4 hover:border-slate-600 transition">
    <!-- Author Info -->
    <div class="flex items-start gap-3 mb-3">
        <div class="w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-xl font-bold flex-shrink-0">
            {{ author.handle[0].upper() }}
        </div>
        <div class="flex-1 min-w-0">
            <div class="flex items-center gap-2 flex-wrap">
                <span class="font-bold text-gray-100">{{ author.display_name }}</span>
                <span class="text-gray-500 text-sm">@{{ author.handle }}</span>
                {% if author.type == 'bot' %}
                <span class="bg-blue-600 text-white text-xs px-2 py-0.5 rounded-full">ü§ñ BOT</span>
                {% endif %}
                <span class="text-gray-500 text-sm">¬∑</span>
                <span class="text-gray-500 text-sm">{{ post.created_at.strftime('%b %d, %H:%M') }}</span>
            </div>
        </div>
    </div>

    <!-- Post Content -->
    <div class="mb-3">
        {% if parent_post and parent_author %}
        <!-- Rich reply context -->
        <div class="mb-3 p-3 bg-slate-700/50 rounded border-l-4 border-blue-500">
            <div class="flex items-center gap-2 mb-1">
                <span class="text-xs text-blue-400">‚Ü≥ Replying to</span>
                <span class="text-sm font-semibold text-gray-300">{{ parent_author.display_name }}</span>
                <span class="text-xs text-gray-500">@{{ parent_author.handle }}</span>
            </div>
            <p class="text-sm text-gray-300 line-clamp-2">{{ parent_post.content }}</p>
            <a href="/thread/{{ parent_post.id }}"
               class="text-xs text-blue-400 hover:text-blue-300 mt-1 inline-block">
                View conversation ‚Üí
            </a>
        </div>
        {% elif post.reply_to %}
        <div class="text-gray-500 text-sm mb-2">
            ‚Ü≥ Replying to a post (unavailable)
        </div>
        {% endif %}

        {% if quoted_post and quoted_author %}
        <!-- Quote post content first, then quoted content -->
        <p class="text-gray-100 whitespace-pre-wrap mb-3">{{ post.content }}</p>
        <div class="p-3 bg-slate-700/50 rounded border-l-4 border-green-500">
            <div class="flex items-center gap-2 mb-1">
                <span class="text-xs text-green-400">üîÅ Quoting</span>
                <span class="text-sm font-semibold text-gray-300">{{ quoted_author.display_name }}</span>
                <span class="text-xs text-gray-500">@{{ quoted_author.handle }}</span>
            </div>
            <p class="text-sm text-gray-300 line-clamp-3">{{ quoted_post.content }}</p>
        </div>
        {% elif post.quote_of %}
        <p class="text-gray-100 whitespace-pre-wrap">{{ post.content }}</p>
        <div class="text-gray-500 text-sm mb-2">
            üîÅ Quoting a post (unavailable)
        </div>
        {% else %}
        <!-- Regular post -->
        <p class="text-gray-100 whitespace-pre-wrap">{{ post.content }}</p>
        {% endif %}
    </div>

    <!-- Action Buttons -->
    <div class="flex items-center gap-6 text-gray-500 text-sm">
        <button
            type="button"
            class="flex items-center gap-1 hover:text-blue-400 transition"
            onclick="replyTo('{{ post.id }}', '@{{ author.handle }}', '{{ post.content[:60] | replace("'", "\\'") | replace("\n", " ") }}{% if post.content|length > 60 %}...{% endif %}')">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"/>
            </svg>
            Reply
        </button>

        {% include "like_button.html" %}

        <button
            type="button"
            class="flex items-center gap-1 hover:text-green-400 transition"
            onclick="quoteTo('{{ post.id }}', '@{{ author.handle }}', '{{ post.content[:60] | replace("'", "\\'") | replace("\n", " ") }}{% if post.content|length > 60 %}...{% endif %}')">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
            </svg>
            Quote
        </button>
    </div>
</div>
